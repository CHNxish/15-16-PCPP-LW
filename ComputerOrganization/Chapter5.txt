存储器

计算机中用于存放程序和数据的部件，是Von Neumann结构计算机的重要组成，是计算机的中心

程序和数据的特点
  1.源程序，汇编程序和机器语言程序
  2.各种类型的数据
共同点：二进制数据

对存储介质的基本要求：能保存，能读，能写
  磁颗粒，半导体，光

现代计算机存储器系统
  寄存器 register        ]
  高速缓存 cache         ] 内部存储器
  主存储器 Main Memory   ]
  磁盘 Disk           ] 外部存储器
  光盘 Compact Disc   ]

按访问方式分类
  随机访问存储器(RAM)
    访问时间与存放位置无关
    半导体存储器
  顺序访问存储器(SAM)
    按照存储位置依次访问
    磁带存储器
  直接访问存储器(DAM)
    随机 + 顺序
    磁盘存储器
  关联访问存储器(CAM)
    根据内存访问
    cache

存储器系统设计目标
  尽可能快的存取速度
    应能基本满足CPU对数据的访问要求
  尽可能大的存储空间
    可以满足程序对存储空间的要求
  尽可能低的单位成本
    用户能够承受的范围内
  较高的可靠性

为了满足目标：层次存储器系统
  高速度：静态存储器(SRAM)速度高，设置较小容量的高速缓冲存储器
  大容量：动态存储器(DRAM)价格适中，速度适中，可作为主存储器
  低成本：磁盘存储器价格低廉，作为辅助存储器，暂存CPU访问频率不高的数据和程序，作为虚拟存储器的载体

为什么层次存储器系统可以使用？程序运行时的局部性原理表现在：
  在一小段时间内，最近被访问过的程序和数据很可能再次被访问
  在空间上，这些被访问的程序和数据往往集中在一小片存储区
  在访问顺序上，指令顺序执行比转移执行的可能性大(大约5:1)
所以可以合理的把程序和数据分配在不同存储介质上

层次之间应该满足的原则：一致性原则，包含性原则

为了满足目标：并行技术
  一体多字，单字多体

动态存储器的读写过程

动态存储器的工作特点：
  破坏性读出：
    读出时被强制清零
    预充电延迟
  需定时刷新：
    集中刷新
    分散刷新
  快速分页组织(行列地址译码器)

静态存储器
  速度快，能耗高，价格高
  存储密度低，单位面积存储容量小
  数据入/出共用管脚

            SRAM        DRAM
存储信息     触发器       电容
破坏性读出    非          是
需要刷新     不要         需要
送行列地址   同时送       分两次送
访问速度      快          慢
集成度       低           高
发热量       大           小
存储成本      高          低

高速缓冲存储器cache
定义：设置于主存和CPU之间的存储器，用高速的静态存储器实现，缓存了CPU频繁访问的信息，提高CPU对存储器的平均访问速度
特点：1.与CPU的运行速度基本匹配 2.全硬件管理，对程序员透明

cache的参数
  1.块(Line)：数据交换中最小的单位
  2.命中(Hit)：在较高层次中发现要访问的内容
    命中率：命中次数 / 访问次数
    命中时间：访问在较高层次中数据的时间
  3.失效(Miss)：需要在较低层次中访问块
    失效率：1 - 命中率
    失效损失：替换较高层次数据块的时间 + 将该块交付给处理器的时间
命中时间 << 失效损失
平均访问时间 = 命中率 * 命中时间 + 失效率 * 失效损失

需要解决的问题：1.主存地址和缓存地址的映象和转换 2.按一定原则对cache的内容进行替换

主存地址在cache中寻找数据：
  全相联映射
  直接映射 
  组相联映射
有效位 标记 索引 块内地址

一致性的保证：
  写直达(write through) 
    强一致性保证，效率低
    在cache中命中
      同时修改cache和对应的主存内容
    没有在cache中命中
      写分配(write allocate)
      非写分配(not write allocate)
  拖后写(write back)
    弱一致性保证，替换时再写主存
      主动替换
      被动替换
    通过监听总线上的访问操作来实现
    实现复杂，效率比较高

cache缺失的四类原因：
  开机缺失 容量缺失 冲突缺失 无效缺失

调度算法：
1.FIFO:先进先出调度算法
2.LRU:最近最久未使用调度算法

虚拟存储器
定义：设置在主存--辅存层次，主要目的是实现存储管理，并帮助解决存储容量的问题
特点：1.克服存储容量的不足 2.获得对主存储器管理的便利 3.由操作系统管理

存储管理：
  1.段式存储管理：段(Segment)
    以段作为存储管理的对象，容易实现共享和保护，容易产生碎片
    设置段表进行管理，段表基地址 段起始地址 段长 装入位 保护，共享等标志
  2.页式存储管理
    将主存和虚存划分为固定大小的页，以页作为单位进行管理和数据交换
    设置页表进行管理 页表基地址寄存器 实页号 控制位
  3.段页式存储管理：结合段式存储管理和页式存储管理
    分段，再在段内分页

主存中存放CPU要立即访问的程序和数据
辅助存储器中存放CPU不立即使用的信息，在需要的时候掉入主存中

磁表面存储原理
  保存：磁颗粒的不同磁化偏转方向
  表示：磁记录方式
  组织：扇区，磁道，柱面，硬盘

磁记录方式：
  指一种编码方式，即如何将一串二进制信息，通过读写电路变换成磁层介质中的磁化翻转序列

  归零制(RZ) 不归零制(NRZ) 见1翻转的不归零制(NRZ1)
  调向制(PM) 调频制(FM)  改进的调频制(MFM)

  磁盘访问过程：寻道 -> 寻找扇区 -> 数据传输
  磁盘访问时间 = 寻道时间 + 旋转延迟 + 传输时间 + 磁盘控制器延迟

RAID：磁盘阵列 Redundant Arrays of Independent Disks

光盘的存储原理
1.只读光盘(CD-ROM)
2.CD-R
3.CD-RW  晶态和非晶态
存储原理：光电转换 编码方式：NRZ1

内存除了DRAM外，还能用EDRAM和SDRAM

FlashMemory使用ROM，EPROM，EEPROM 晶体管